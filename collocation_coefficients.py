import numpy as np
from numba import cuda


'''
        Define the lobatto coefficients for collocation points
'''


class lobatto:
    """
        Input: m - stages of the lobatto coefficients
    """
    def __init__(self, m):
        self.m = m
        self.stages = m
        self.order = 2 * (m - 1)
        self.A = np.zeros((m, m), dtype=np.float64)
        self.b = np.zeros(m, dtype=np.float64)
        self.c = np.zeros(m, dtype=np.float64)
        self.d = np.zeros((m + 1), dtype=np.float64)
        self.w = np.zeros(m, dtype=np.float64)

        if m == 3:
            self.A[0, 0] = 0.0000000000000000e+00
            self.A[0, 1] = 0.0000000000000000e+00
            self.A[0, 2] = 0.0000000000000000e+00
            self.A[1, 0] = 2.0833333333333337e-01
            self.A[1, 1] = 3.3333333333333337e-01
            self.A[1, 2] = -4.1666666666666671e-02
            self.A[2, 0] = 1.6666666666666652e-01
            self.A[2, 1] = 6.6666666666666674e-01
            self.A[2, 2] = 1.6666666666666663e-01
            self.b[0] = 1.6666666666666652e-01
            self.b[1] = 6.6666666666666674e-01
            self.b[2] = 1.6666666666666663e-01
            self.c[0] = 0.0000000000000000e+00
            self.c[1] = 5.0000000000000000e-01
            self.c[2] = 1.0000000000000000e+00
            self.w[0] = 1.6666666666666666e-01
            self.w[1] = 6.6666666666666663e-01
            self.w[2] = 1.6666666666666666e-01
            self.d[0] = 0.0000000000000000e+00
            self.d[1] = 2.7639320225002106e-01
            self.d[2] = 7.2360679774997894e-01
            self.d[3] = 1.0000000000000000e+00
        elif m == 4:
            self.A[0, 0] = 0.0000000000000000e+00
            self.A[0, 1] = 0.0000000000000000e+00
            self.A[0, 2] = 0.0000000000000000e+00
            self.A[0, 3] = 0.0000000000000000e+00
            self.A[1, 0] = 1.1030056647916493e-01
            self.A[1, 1] = 1.8969943352083510e-01
            self.A[1, 2] = -3.3907364229143935e-02
            self.A[1, 3] = 1.0300566479164927e-02
            self.A[2, 0] = 7.3032766854168651e-02
            self.A[2, 1] = 4.5057403089580994e-01
            self.A[2, 2] = 2.2696723314583123e-01
            self.A[2, 3] = -2.6967233145831493e-02
            self.A[3, 0] = 8.3333333333333925e-02
            self.A[3, 1] = 4.1666666666666519e-01
            self.A[3, 2] = 4.1666666666666607e-01
            self.A[3, 3] = 8.3333333333333259e-02
            self.b[0] = 8.3333333333333925e-02
            self.b[1] = 4.1666666666666519e-01
            self.b[2] = 4.1666666666666607e-01
            self.b[3] = 8.3333333333333259e-02
            self.c[0] = 0.0000000000000000e+00
            self.c[1] = 2.7639320225002106e-01
            self.c[2] = 7.2360679774997894e-01
            self.c[3] = 1.0000000000000000e+00
            self.w[0] = 8.3333333333333925e-02
            self.w[1] = 4.1666666666666519e-01
            self.w[2] = 4.1666666666666607e-01
            self.w[3] = 8.3333333333333259e-02
            self.d[0] = 0.0000000000000000e+00
            self.d[1] = 1.7267316464601140e-01
            self.d[2] = 5.0000000000000000e-01
            self.d[3] = 8.2732683535398865e-01
            self.d[4] = 1.0000000000000000e+00
        elif m == 5:
            self.A[0, 0] = 0.0000000000000000e+00
            self.A[0, 1] = 0.0000000000000000e+00
            self.A[0, 2] = 0.0000000000000000e+00
            self.A[0, 3] = 0.0000000000000000e+00
            self.A[0, 4] = 0.0000000000000000e+00
            self.A[1, 0] = 6.7728432186156914e-02
            self.A[1, 1] = 1.1974476934341162e-01
            self.A[1, 2] = -2.1735721866558116e-02
            self.A[1, 3] = 1.0635824225415494e-02
            self.A[1, 4] = -3.7001392424145354e-03
            self.A[2, 0] = 4.0625000000000022e-02
            self.A[2, 1] = 3.0318418332304287e-01
            self.A[2, 2] = 1.7777777777777748e-01
            self.A[2, 3] = -3.0961961100820501e-02
            self.A[2, 4] = 9.3749999999999667e-03
            self.A[3, 0] = 5.3700139242415901e-02
            self.A[3, 1] = 2.6158639799680827e-01
            self.A[3, 2] = 3.7729127742211288e-01
            self.A[3, 3] = 1.5247745287881109e-01
            self.A[3, 4] = -1.7728432186157494e-02
            self.A[4, 0] = 5.0000000000000711e-02
            self.A[4, 1] = 2.7222222222222214e-01
            self.A[4, 2] = 3.5555555555555296e-01
            self.A[4, 3] = 2.7222222222222214e-01
            self.A[4, 4] = 4.9999999999999822e-02
            self.b[0] = 5.0000000000000711e-02
            self.b[1] = 2.7222222222222214e-01
            self.b[2] = 3.5555555555555296e-01
            self.b[3] = 2.7222222222222214e-01
            self.b[4] = 4.9999999999999822e-02
            self.c[0] = 0.0000000000000000e+00
            self.c[1] = 1.7267316464601140e-01
            self.c[2] = 5.0000000000000000e-01
            self.c[3] = 8.2732683535398865e-01
            self.c[4] = 1.0000000000000000e+00
            self.w[0] = 5.0000000000000711e-02
            self.w[1] = 2.7222222222222214e-01
            self.w[2] = 3.5555555555555296e-01
            self.w[3] = 2.7222222222222214e-01
            self.w[4] = 4.9999999999999822e-02
            self.d[0] = 0.0000000000000000e+00
            self.d[1] = 1.1747233803526763e-01
            self.d[2] = 3.5738424175967742e-01
            self.d[3] = 6.4261575824032258e-01
            self.d[4] = 8.8252766196473242e-01
            self.d[5] = 1.0000000000000000e+00
        elif m == 6:
            self.A[0, 0] = 0.0000000000000000e+00
            self.A[0, 1] = 0.0000000000000000e+00
            self.A[0, 2] = 0.0000000000000000e+00
            self.A[0, 3] = 0.0000000000000000e+00
            self.A[0, 4] = 0.0000000000000000e+00
            self.A[0, 5] = 0.0000000000000000e+00
            self.A[1, 0] = 4.5679805133755025e-02
            self.A[1, 1] = 8.1867817008970653e-02
            self.A[1, 2] = -1.4874605789089831e-02
            self.A[1, 3] = 7.6276761182509575e-03
            self.A[1, 4] = -4.4717804405737050e-03
            self.A[1, 5] = 1.6434260039545328e-03
            self.A[2, 0] = 2.5908385387879651e-02
            self.A[2, 1] = 2.1384080863282540e-01
            self.A[2, 2] = 1.3396073565086108e-01
            self.A[2, 3] = -2.4004074733155134e-02
            self.A[2, 4] = 1.1807696377659785e-02
            self.A[2, 5] = -4.1293095563937343e-03
            self.A[3, 0] = 3.7462642889726894e-02
            self.A[3, 1] = 1.7742978177126290e-01
            self.A[3, 2] = 3.0143326325089825e-01
            self.A[3, 3] = 1.4346845286688215e-01
            self.A[3, 4] = -2.4603330483902175e-02
            self.A[3, 5] = 7.4249479454537859e-03
            self.A[4, 0] = 3.1689907329379707e-02
            self.A[4, 1] = 1.9370925858949306e-01
            self.A[4, 2] = 2.6980151239950168e-01
            self.A[4, 3] = 2.9230379430683229e-01
            self.A[4, 4] = 1.0736966113995816e-01
            self.A[4, 5] = -1.2346471800425363e-02
            self.A[5, 0] = 3.3333333333338544e-02
            self.A[5, 1] = 1.8923747814893233e-01
            self.A[5, 2] = 2.7742918851774689e-01
            self.A[5, 3] = 2.7742918851774689e-01
            self.A[5, 4] = 1.8923747814892877e-01
            self.A[5, 5] = 3.3333333333332327e-02
            self.b[0] = 3.3333333333338544e-02
            self.b[1] = 1.8923747814893233e-01
            self.b[2] = 2.7742918851774689e-01
            self.b[3] = 2.7742918851774689e-01
            self.b[4] = 1.8923747814892877e-01
            self.b[5] = 3.3333333333332327e-02
            self.c[0] = 0.0000000000000000e+00
            self.c[1] = 1.1747233803526763e-01
            self.c[2] = 3.5738424175967742e-01
            self.c[3] = 6.4261575824032258e-01
            self.c[4] = 8.8252766196473242e-01
            self.c[5] = 1.0000000000000000e+00
            self.w[0] = 3.3333333333338544e-02
            self.w[1] = 1.8923747814893233e-01
            self.w[2] = 2.7742918851774689e-01
            self.w[3] = 2.7742918851774689e-01
            self.w[4] = 1.8923747814892877e-01
            self.w[5] = 3.3333333333332327e-02
            self.d[0] = 0.0000000000000000e+00
            self.d[1] = 8.4888051860716518e-02
            self.d[2] = 2.6557560326464291e-01
            self.d[3] = 5.0000000000000000e-01
            self.d[4] = 7.3442439673535709e-01
            self.d[5] = 9.1511194813928354e-01
            self.d[6] = 1.0000000000000000e+00
        elif m == 7:
            self.A[0, 0] = 0.0000000000000000e+00
            self.A[0, 1] = 0.0000000000000000e+00
            self.A[0, 2] = 0.0000000000000000e+00
            self.A[0, 3] = 0.0000000000000000e+00
            self.A[0, 4] = 0.0000000000000000e+00
            self.A[0, 5] = 0.0000000000000000e+00
            self.A[0, 6] = 0.0000000000000000e+00
            self.A[1, 0] = 3.2846264328292657e-02
            self.A[1, 1] = 5.9322894027551372e-02
            self.A[1, 2] = -1.0768594451189257e-02
            self.A[1, 3] = 5.5975917805697814e-03
            self.A[1, 4] = -3.4889299708074622e-03
            self.A[1, 5] = 2.2170965889145391e-03
            self.A[1, 6] = -8.3827044261510517e-04
            self.A[2, 0] = 1.8002223201814993e-02
            self.A[2, 1] = 1.5770113064168903e-01
            self.A[2, 2] = 1.0235481204686181e-01
            self.A[2, 3] = -1.8478259273458864e-02
            self.A[2, 4] = 9.5775801007413897e-03
            self.A[2, 5] = -5.6818645662243261e-03
            self.A[2, 6] = 2.0999811132187372e-03
            self.A[3, 0] = 2.7529761904761862e-02
            self.A[3, 1] = 1.2778825555983758e-01
            self.A[3, 2] = 2.3748565272164512e-01
            self.A[3, 3] = 1.2190476190476490e-01
            self.A[3, 4] = -2.1612962116713597e-02
            self.A[3, 5] = 1.0624768120944206e-02
            self.A[3, 6] = -3.7202380952390257e-03
            self.A[4, 0] = 2.1709542696303430e-02
            self.A[4, 1] = 1.4409488824701366e-01
            self.A[4, 2] = 2.0629511050420035e-01
            self.A[4, 3] = 2.6228778308299461e-01
            self.A[4, 4] = 1.1351787855807061e-01
            self.A[4, 5] = -1.9288106960918761e-02
            self.A[4, 6] = 5.8073006077066225e-03
            self.A[5, 0] = 2.4647794252146582e-02
            self.A[5, 1] = 1.3619592709186179e-01
            self.A[5, 2] = 2.1936162057579622e-01
            self.A[5, 3] = 2.3821193202899593e-01
            self.A[5, 4] = 2.2664128505611814e-01
            self.A[5, 5] = 7.9090129653224039e-02
            self.A[5, 6] = -9.0367405187805616e-03
            self.A[6, 0] = 2.3809523809518396e-02
            self.A[6, 1] = 1.3841302368081898e-01
            self.A[6, 2] = 2.1587269060492531e-01
            self.A[6, 3] = 2.4380952380957410e-01
            self.A[6, 4] = 2.1587269060488268e-01
            self.A[6, 5] = 1.3841302368073372e-01
            self.A[6, 6] = 2.3809523809497080e-02
            self.b[0] = 2.3809523809518396e-02
            self.b[1] = 1.3841302368081898e-01
            self.b[2] = 2.1587269060492531e-01
            self.b[3] = 2.4380952380957410e-01
            self.b[4] = 2.1587269060488268e-01
            self.b[5] = 1.3841302368073372e-01
            self.b[6] = 2.3809523809497080e-02
            self.c[0] = 0.0000000000000000e+00
            self.c[1] = 8.4888051860716518e-02
            self.c[2] = 2.6557560326464291e-01
            self.c[3] = 5.0000000000000000e-01
            self.c[4] = 7.3442439673535709e-01
            self.c[5] = 9.1511194813928354e-01
            self.c[6] = 1.0000000000000000e+00
            self.w[0] = 2.3809523809518396e-02
            self.w[1] = 1.3841302368081898e-01
            self.w[2] = 2.1587269060492531e-01
            self.w[3] = 2.4380952380957410e-01
            self.w[4] = 2.1587269060488268e-01
            self.w[5] = 1.3841302368073372e-01
            self.w[6] = 2.3809523809497080e-02
            self.d[0] = 0.0000000000000000e+00
            self.d[1] = 6.4129925745196714e-02
            self.d[2] = 2.0414990928342885e-01
            self.d[3] = 3.9535039104876057e-01
            self.d[4] = 6.0464960895123943e-01
            self.d[5] = 7.9585009071657109e-01
            self.d[6] = 9.3587007425480329e-01
            self.d[7] = 1.0000000000000000e+00
        elif m == 8:
            self.A[0, 0] = 0.0000000000000000e+00
            self.A[0, 1] = 0.0000000000000000e+00
            self.A[0, 2] = 0.0000000000000000e+00
            self.A[0, 3] = 0.0000000000000000e+00
            self.A[0, 4] = 0.0000000000000000e+00
            self.A[0, 5] = 0.0000000000000000e+00
            self.A[0, 6] = 0.0000000000000000e+00
            self.A[0, 7] = 0.0000000000000000e+00
            self.A[1, 0] = 2.4737514438875521e-02
            self.A[1, 1] = 4.4892662602755040e-02
            self.A[1, 2] = -8.1407677423897609e-03
            self.A[1, 3] = 4.2540825485459493e-03
            self.A[1, 4] = -2.7042050750158246e-03
            self.A[1, 5] = 1.8453866944819924e-03
            self.A[1, 6] = -1.2262209861064904e-03
            self.A[1, 7] = 4.7147326405026817e-04
            self.A[2, 0] = 1.3258719822130158e-02
            self.A[2, 1] = 1.2064973282409734e-01
            self.A[2, 2] = 7.9997635786651866e-02
            self.A[2, 3] = -1.4480830962625474e-02
            self.A[2, 4] = 7.6319492068339517e-03
            self.A[2, 5] = -4.8326689231347111e-03
            self.A[2, 6] = 3.1049500159209265e-03
            self.A[2, 7] = -1.1795784864451070e-03
            self.A[3, 0] = 2.1034356725211811e-02
            self.A[3, 1] = 9.6280178312076470e-02
            self.A[3, 2] = 1.8904164984432792e-01
            self.A[3, 3] = 1.0124595564768946e-01
            self.A[3, 4] = -1.8137320211454422e-02
            self.A[3, 5] = 9.4170098024304316e-03
            self.A[3, 6] = -5.6088616425369331e-03
            self.A[3, 7] = 2.0774225710099015e-03
            self.A[4, 0] = 1.5779720286122512e-02
            self.A[4, 1] = 1.1096097521425818e-01
            self.A[4, 2] = 1.6114433643933035e-01
            self.A[4, 3] = 2.2436671754080351e-01
            self.A[4, 4] = 1.0498344168167084e-01
            self.A[4, 5] = -1.8480303602576242e-02
            self.A[4, 6] = 9.0719352596835279e-03
            self.A[4, 7] = -3.1772138680716822e-03
            self.A[5, 0] = 1.9036721343596241e-02
            self.A[5, 1] = 1.0224716355585883e-01
            self.A[5, 2] = 1.7539401516480879e-01
            self.A[5, 3] = 1.9859744812248437e-01
            self.A[5, 4] = 2.2071022829192799e-01
            self.A[5, 5] = 9.0563710455072055e-02
            self.A[5, 6] = -1.5297619252315542e-02
            self.A[5, 7] = 4.5984230350200050e-03
            self.A[6, 0] = 1.7385669593124931e-02
            self.A[6, 1] = 1.0657833455775290e-01
            self.A[6, 2] = 1.6871595954729202e-01
            self.A[6, 3] = 2.0893360240415859e-01
            self.A[6, 4] = 2.0197531478067221e-01
            self.A[6, 5] = 1.7870211398394531e-01
            self.A[6, 6] = 6.0459450969005957e-02
            self.A[6, 7] = -6.8803715817722377e-03
            self.A[7, 0] = 1.7857142857167219e-02
            self.A[7, 1] = 1.0535211357193930e-01
            self.A[7, 2] = 1.7056134624166042e-01
            self.A[7, 3] = 2.0622939732925261e-01
            self.A[7, 4] = 2.0622939732923884e-01
            self.A[7, 5] = 1.7056134624181141e-01
            self.A[7, 6] = 1.0535211357176877e-01
            self.A[7, 7] = 1.7857142857138797e-02
            self.b[0] = 1.7857142857167219e-02
            self.b[1] = 1.0535211357193930e-01
            self.b[2] = 1.7056134624166042e-01
            self.b[3] = 2.0622939732925261e-01
            self.b[4] = 2.0622939732923884e-01
            self.b[5] = 1.7056134624181141e-01
            self.b[6] = 1.0535211357176877e-01
            self.b[7] = 1.7857142857138797e-02
            self.c[0] = 0.0000000000000000e+00
            self.c[1] = 6.4129925745196714e-02
            self.c[2] = 2.0414990928342885e-01
            self.c[3] = 3.9535039104876057e-01
            self.c[4] = 6.0464960895123943e-01
            self.c[5] = 7.9585009071657109e-01
            self.c[6] = 9.3587007425480329e-01
            self.c[7] = 1.0000000000000000e+00
            self.w[0] = 1.7857142857167219e-02
            self.w[1] = 1.0535211357193930e-01
            self.w[2] = 1.7056134624166042e-01
            self.w[3] = 2.0622939732925261e-01
            self.w[4] = 2.0622939732923884e-01
            self.w[5] = 1.7056134624181141e-01
            self.w[6] = 1.0535211357176877e-01
            self.w[7] = 1.7857142857138797e-02
            self.d[0] = 0.0000000000000000e+00
            self.d[1] = 5.0121002294269912e-02
            self.d[2] = 1.6140686024463113e-01
            self.d[3] = 3.1844126808691092e-01
            self.d[4] = 5.0000000000000000e-01
            self.d[5] = 6.8155873191308913e-01
            self.d[6] = 8.3859313975536887e-01
            self.d[7] = 9.4987899770573003e-01
            self.d[8] = 1.0000000000000000e+00
        elif m == 9:
            self.A[0, 0] = 0.0000000000000000e+00
            self.A[0, 1] = 0.0000000000000000e+00
            self.A[0, 2] = 0.0000000000000000e+00
            self.A[0, 3] = 0.0000000000000000e+00
            self.A[0, 4] = 0.0000000000000000e+00
            self.A[0, 5] = 0.0000000000000000e+00
            self.A[0, 6] = 0.0000000000000000e+00
            self.A[0, 7] = 0.0000000000000000e+00
            self.A[0, 8] = 0.0000000000000000e+00
            self.A[1, 0] = 1.9293838201043211e-02
            self.A[1, 1] = 3.5125520977621762e-02
            self.A[1, 2] = -6.3641024187047843e-03
            self.A[1, 3] = 3.3337771969983807e-03
            self.A[1, 4] = -2.1368470176082377e-03
            self.A[1, 5] = 1.4942991627282295e-03
            self.A[1, 6] = -1.0740606993816576e-03
            self.A[1, 7] = 7.3377266653928920e-04
            self.A[1, 8] = -2.8519577496630149e-04
            self.A[2, 0] = 1.0184080408227667e-02
            self.A[2, 1] = 9.5086508449361853e-02
            self.A[2, 2] = 6.3931995628437835e-02
            self.A[2, 3] = -1.1585731333842719e-02
            self.A[2, 4] = 6.1499369005517529e-03
            self.A[2, 5] = -3.9808257871827013e-03
            self.A[2, 6] = 2.7553240894192185e-03
            self.A[2, 7] = -1.8475051393836428e-03
            self.A[2, 8] = 7.1307702904133997e-04
            self.A[3, 0] = 1.6569369843571505e-02
            self.A[3, 1] = 7.5093517096208373e-02
            self.A[3, 2] = 1.5288206102488200e-01
            self.A[3, 3] = 8.4085478688912918e-02
            self.A[3, 4] = -1.5130673172334186e-02
            self.A[3, 5] = 8.0006035703998890e-03
            self.A[3, 6] = -5.0963258617404972e-03
            self.A[3, 7] = 3.2896245700400062e-03
            self.A[3, 8] = -1.2523876730272665e-03
            self.A[4, 0] = 1.1990017361114713e-02
            self.A[4, 1] = 8.7869833723072333e-02
            self.A[4, 2] = 1.2868222230657977e-01
            self.A[4, 3] = 1.8975808031592756e-01
            self.A[4, 4] = 9.2879818594119201e-02
            self.A[4, 5] = -1.6543824829402531e-02
            self.A[4, 6] = 8.5871339435147909e-03
            self.A[4, 7] = -5.1221529426661583e-03
            self.A[4, 8] = 1.8988715277732382e-03
            self.A[5, 0] = 1.5141276561891459e-02
            self.A[5, 1] = 7.9458056210455652e-02
            self.A[5, 2] = 1.4236568211163103e-01
            self.A[5, 3] = 1.6521365191590576e-01
            self.A[5, 4] = 2.0089031036048910e-01
            self.A[5, 5] = 8.9128776797757325e-02
            self.A[5, 6] = -1.5612704774772279e-02
            self.A[5, 7] = 7.6541636841600535e-03
            self.A[5, 8] = -2.6804809547229524e-03
            self.A[6, 0] = 1.3175811859639452e-02
            self.A[6, 1] = 8.4595185919852156e-02
            self.A[6, 2] = 1.3451403216049584e-01
            self.A[6, 3] = 1.7719508127309780e-01
            self.A[6, 4] = 1.7960970028762757e-01
            self.A[6, 5] = 1.8479998682074239e-01
            self.A[6, 6] = 7.3337360621481551e-02
            self.A[6, 7] = -1.2338827669076124e-02
            self.A[6, 8] = 3.7048084805633152e-03
            self.A[7, 0] = 1.4174084663636677e-02
            self.A[7, 1] = 8.2013908114277001e-02
            self.A[7, 2] = 1.3834341694973773e-01
            self.A[7, 3] = 1.7171995632256198e-01
            self.A[7, 4] = 1.8789648420532101e-01
            self.A[7, 5] = 1.6988047829077146e-01
            self.A[7, 6] = 1.4363345866920296e-01
            self.A[7, 7] = 4.7622159803086817e-02
            self.A[7, 8] = -5.4049493121510750e-03
            self.A[8, 0] = 1.3888888888573092e-02
            self.A[8, 1] = 8.2747680780357769e-02
            self.A[8, 2] = 1.3726935624890757e-01
            self.A[8, 3] = 1.7321425548614400e-01
            self.A[8, 4] = 1.8575963718829991e-01
            self.A[8, 5] = 1.7321425548779956e-01
            self.A[8, 6] = 1.3726935624930703e-01
            self.A[8, 7] = 8.2747680780148158e-02
            self.A[8, 8] = 1.3888888888800466e-02
            self.b[0] = 1.3888888888573092e-02
            self.b[1] = 8.2747680780357769e-02
            self.b[2] = 1.3726935624890757e-01
            self.b[3] = 1.7321425548614400e-01
            self.b[4] = 1.8575963718829991e-01
            self.b[5] = 1.7321425548779956e-01
            self.b[6] = 1.3726935624930703e-01
            self.b[7] = 8.2747680780148158e-02
            self.b[8] = 1.3888888888800466e-02
            self.c[0] = 0.0000000000000000e+00
            self.c[1] = 5.0121002294269912e-02
            self.c[2] = 1.6140686024463113e-01
            self.c[3] = 3.1844126808691092e-01
            self.c[4] = 5.0000000000000000e-01
            self.c[5] = 6.8155873191308913e-01
            self.c[6] = 8.3859313975536887e-01
            self.c[7] = 9.4987899770573003e-01
            self.c[8] = 1.0000000000000000e+00
            self.w[0] = 1.3888888888573092e-02
            self.w[1] = 8.2747680780357769e-02
            self.w[2] = 1.3726935624890757e-01
            self.w[3] = 1.7321425548614400e-01
            self.w[4] = 1.8575963718829991e-01
            self.w[5] = 1.7321425548779956e-01
            self.w[6] = 1.3726935624930703e-01
            self.w[7] = 8.2747680780148158e-02
            self.w[8] = 1.3888888888800466e-02
            self.d[0] = 0.0000000000000000e+00
            self.d[1] = 4.0233045916770571e-02
            self.d[2] = 1.3061306744724749e-01
            self.d[3] = 2.6103752509477773e-01
            self.d[4] = 4.1736052116680650e-01
            self.d[5] = 5.8263947883319356e-01
            self.d[6] = 7.3896247490522227e-01
            self.d[7] = 8.6938693255275257e-01
            self.d[8] = 9.5976695408322943e-01
            self.d[9] = 1.0000000000000000e+00
        elif m == 10: 
            self.A[0, 0] = 0.0000000000000000e+00
            self.A[0, 1] = 0.0000000000000000e+00
            self.A[0, 2] = 0.0000000000000000e+00
            self.A[0, 3] = 0.0000000000000000e+00
            self.A[0, 4] = 0.0000000000000000e+00
            self.A[0, 5] = 0.0000000000000000e+00
            self.A[0, 6] = 0.0000000000000000e+00
            self.A[0, 7] = 0.0000000000000000e+00
            self.A[0, 8] = 0.0000000000000000e+00
            self.A[0, 9] = 0.0000000000000000e+00
            self.A[1, 0] = 1.5465148886122203e-02
            self.A[1, 1] = 2.8217976000731632e-02
            self.A[1, 2] = -5.1090759506765750e-03
            self.A[1, 3] = 2.6797026134601915e-03
            self.A[1, 4] = -1.7246233123523059e-03
            self.A[1, 5] = 1.2191900098376621e-03
            self.A[1, 6] = -9.0141037896695857e-04
            self.A[1, 7] = 6.6976025819376057e-04
            self.A[1, 8] = -4.6614172744751455e-04
            self.A[1, 9] = 1.8251951786848498e-04
            self.A[2, 0] = 8.0745648288632049e-03
            self.A[2, 1] = 7.6774514675232330e-02
            self.A[2, 2] = 5.2118036265195872e-02
            self.A[2, 3] = -9.4497054574489425e-03
            self.A[2, 4] = 5.0342308481156894e-03
            self.A[2, 5] = -3.2904586839602734e-03
            self.A[2, 6] = 2.3383540355341736e-03
            self.A[2, 7] = -1.7004415361783851e-03
            self.A[2, 8] = 1.1701705230945788e-03
            self.A[2, 9] = -4.5619805120070134e-04
            self.A[3, 0] = 1.3376018525483134e-02
            self.A[3, 1] = 6.0184542475475666e-02
            self.A[3, 2] = 1.2565307727248745e-01
            self.A[3, 3] = 7.0355532309858582e-02
            self.A[3, 4] = -1.2689136533026415e-02
            self.A[3, 5] = 6.7646974964830076e-03
            self.A[3, 6] = -4.4106165482058479e-03
            self.A[3, 7] = 3.0723444103200048e-03
            self.A[3, 8] = -2.0690098877445828e-03
            self.A[3, 9] = 8.0007557365130433e-04
            self.A[4, 0] = 9.4248721168792571e-03
            self.A[4, 1] = 7.1199715230434890e-02
            self.A[4, 2] = 1.0482643149414173e-01
            self.A[4, 3] = 1.6070946771131567e-01
            self.A[4, 4] = 8.0966723864505263e-02
            self.A[4, 5] = -1.4500644574203747e-02
            self.A[4, 6] = 7.6716787853250423e-03
            self.A[4, 7] = -4.8992681562403106e-03
            self.A[4, 8] = 3.1694435943592225e-03
            self.A[4, 9] = -1.2078988997579199e-03
            self.A[5, 0] = 1.2319010010862108e-02
            self.A[5, 1] = 6.3483551831041041e-02
            self.A[5, 2] = 1.1734393918786168e-01
            self.A[5, 3] = 1.3834966305439167e-01
            self.A[5, 4] = 1.7827052516633124e-01
            self.A[5, 5] = 8.2803156727550231e-02
            self.A[5, 6] = -1.4688125871529678e-02
            self.A[5, 7] = 7.6182395373507461e-03
            self.A[5, 8] = -4.5467198048072532e-03
            self.A[5, 9] = 1.6862389942473577e-03
            self.A[6, 0] = 1.0311035537515778e-02
            self.A[6, 1] = 6.8722005312793044e-02
            self.A[6, 2] = 1.0937232662314500e-01
            self.A[6, 3] = 1.5043195838740075e-01
            self.A[6, 4] = 1.5700518309623135e-01
            self.A[6, 5] = 1.7645901712502621e-01
            self.A[6, 6] = 7.5665809530107708e-02
            self.A[6, 7] = -1.3208406241574266e-02
            self.A[6, 8] = 6.4684529503438171e-03
            self.A[6, 9] = -2.2649074143075154e-03
            self.A[7, 0] = 1.1567309161193862e-02
            self.A[7, 1] = 6.5482824903028813e-02
            self.A[7, 2] = 1.1414511257038384e-01
            self.A[7, 3] = 1.4368298780719613e-01
            self.A[7, 4] = 1.6706033927613362e-01
            self.A[7, 5] = 1.5873564974260290e-01
            self.A[7, 6] = 1.5547104729751027e-01
            self.A[7, 7] = 6.0326634765260678e-02
            self.A[7, 8] = -1.0121519248514232e-02
            self.A[7, 9] = 3.0365462827877110e-03
            self.A[8, 0] = 1.0928591592573866e-02
            self.A[8, 1] = 6.7119137148438313e-02
            self.A[8, 2] = 1.1177491077683044e-01
            self.A[8, 3] = 1.4692275221932505e-01
            self.A[8, 4] = 1.6255069058206573e-01
            self.A[8, 5] = 1.6549450390145637e-01
            self.A[8, 6] = 1.4334163922217158e-01
            self.A[8, 7] = 1.1755374697713705e-01
            self.A[8, 8] = 3.8435019424468919e-02
            self.A[8, 9] = -4.3540377737709690e-03
            self.A[9, 0] = 1.1111111108846217e-02
            self.A[9, 1] = 6.6652995420554362e-02
            self.A[9, 2] = 1.1244467104029354e-01
            self.A[9, 3] = 1.4602134183726889e-01
            self.A[9, 4] = 1.6376988059528230e-01
            self.A[9, 5] = 1.6376988059393227e-01
            self.A[9, 6] = 1.4602134183701310e-01
            self.A[9, 7] = 1.1244467102915223e-01
            self.A[9, 8] = 6.6652995428739814e-02
            self.A[9, 9] = 1.1111111110780669e-02
            self.b[0] = 1.1111111108846217e-02
            self.b[1] = 6.6652995420554362e-02
            self.b[2] = 1.1244467104029354e-01
            self.b[3] = 1.4602134183726889e-01
            self.b[4] = 1.6376988059528230e-01
            self.b[5] = 1.6376988059393227e-01
            self.b[6] = 1.4602134183701310e-01
            self.b[7] = 1.1244467102915223e-01
            self.b[8] = 6.6652995428739814e-02
            self.b[9] = 1.1111111110780669e-02
            self.c[0] = 0.0000000000000000e+00
            self.c[1] = 4.0233045916770571e-02
            self.c[2] = 1.3061306744724749e-01
            self.c[3] = 2.6103752509477773e-01
            self.c[4] = 4.1736052116680650e-01
            self.c[5] = 5.8263947883319356e-01
            self.c[6] = 7.3896247490522227e-01
            self.c[7] = 8.6938693255275257e-01
            self.c[8] = 9.5976695408322943e-01
            self.c[9] = 1.0000000000000000e+00
            self.w[0] = 1.1111111108846217e-02
            self.w[1] = 6.6652995420554362e-02
            self.w[2] = 1.1244467104029354e-01
            self.w[3] = 1.4602134183726889e-01
            self.w[4] = 1.6376988059528230e-01
            self.w[5] = 1.6376988059393227e-01
            self.w[6] = 1.4602134183701310e-01
            self.w[7] = 1.1244467102915223e-01
            self.w[8] = 6.6652995428739814e-02
            self.w[9] = 1.1111111110780669e-02
            self.d[0] = 0.0000000000000000e+00
            self.d[1] = 3.2999284795970418e-02
            self.d[2] = 1.0775826316842779e-01
            self.d[3] = 2.1738233650189748e-01
            self.d[4] = 3.5212093220653029e-01
            self.d[5] = 5.0000000000000000e-01
            self.d[6] = 6.4787906779346971e-01
            self.d[7] = 7.8261766349810258e-01
            self.d[8] = 8.9224173683157226e-01
            self.d[9] = 9.6700071520402964e-01
            self.d[10] = 1.0000000000000000e+00


@cuda.jit(device=True)
def compute_L(m, t, L):
    if m == 3:
        L[0] = (-2.0*t + 1.0)*(-1.0*t + 1.0)
        L[1] = 2.0*t*(-2.0*t + 2.0)
        L[2] = 1.0*t*(2.0*t - 1.0)
    elif m == 4:
        L[0] = (-3.61803398874989*t + 1.0)*(-1.38196601125011*t + 1.0)*(-1.0*t + 1.0)
        L[1] = 3.61803398874989*t*(-2.23606797749979*t + 1.6180339887499)*(-1.38196601125011*t + 1.38196601125011)
        L[2] = 1.38196601125011*t*(-3.61803398874989*t + 3.61803398874989)*(2.23606797749979*t - 0.618033988749895)
        L[3] = 1.0*t*(1.38196601125011*t - 0.381966011250105)*(3.61803398874989*t - 2.61803398874989)
    elif m == 5:
        L[0] = (-5.79128784747792*t + 1.0)*(-2.0*t + 1.0)*(-1.20871215252208*t + 1.0)*(-1.0*t + 1.0)
        L[1] = 5.79128784747792*t*(-3.05505046330389*t + 1.52752523165195)*(-1.52752523165195*t + 1.26376261582597)*(-1.20871215252208*t + 1.20871215252208)
        L[2] = 2.0*t*(-3.05505046330389*t + 2.52752523165195)*(-2.0*t + 2.0)*(3.05505046330389*t - 0.527525231651947)
        L[3] = 1.20871215252208*t*(-5.79128784747792*t + 5.79128784747792)*(1.52752523165195*t - 0.263762615825973)*(3.05505046330389*t - 1.52752523165195)
        L[4] = 1.0*t*(1.20871215252208*t - 0.20871215252208)*(2.0*t - 1.0)*(5.79128784747792*t - 4.79128784747792)
    elif m == 6:
        L[0] = (-8.51264235244709*t + 1.0)*(-2.79810882280716*t + 1.0)*(-1.55613986612825*t + 1.0)*(-1.13310895861751*t + 1.0)*(-1.0*t + 1.0)
        L[1] = 8.51264235244709*t*(-4.1681966775134*t + 1.48964780909833)*(-1.90424170145658*t + 1.22369572485436)*(-1.3070950148596*t + 1.1535475074298)*(-1.13310895861751*t + 1.13310895861751)
        L[2] = 2.79810882280716*t*(-3.50592393273573*t + 2.25296196636787)*(-1.90424170145658*t + 1.68054597660222)*(-1.55613986612825*t + 1.55613986612825)*(4.1681966775134*t - 0.489647809098334)
        L[3] = 1.55613986612825*t*(-4.1681966775134*t + 3.67854886841507)*(-2.79810882280716*t + 2.79810882280716)*(1.90424170145658*t - 0.22369572485436)*(3.50592393273573*t - 1.25296196636787)
        L[4] = 1.13310895861751*t*(-8.51264235244709*t + 8.51264235244709)*(1.3070950148596*t - 0.1535475074298)*(1.90424170145658*t - 0.680545976602217)*(4.1681966775134*t - 2.67854886841507)
        L[5] = 1.0*t*(1.13310895861751*t - 0.133108958617506)*(1.55613986612825*t - 0.556139866128251)*(2.79810882280716*t - 1.79810882280716)*(8.51264235244709*t - 7.51264235244709)
    elif m == 7:
        L[0] = (-11.7802208683124*t + 1.0)*(-3.76540611301375*t + 1.0)*(-2.0*t + 1.0)*(-1.36161054077884*t + 1.0)*(-1.092762477895*t + 1.0)*(-1.0*t + 1.0)
        L[1] = 11.7802208683124*t*(-5.53441558220302*t + 1.46980575696081)*(-2.40898871854314*t + 1.20449435927157)*(-1.53955973039969*t + 1.13069022623684)*(-1.20449435927157*t + 1.10224717963579)*(-1.092762477895*t + 1.092762477895)
        L[2] = 3.76540611301375*t*(-4.2657676160255*t + 2.13288380801275)*(-2.13288380801275*t + 1.56644190400637)*(-1.53955973039969*t + 1.40886950416285)*(-1.36161054077884*t + 1.36161054077884)*(5.53441558220302*t - 0.469805756960808)
        L[3] = 2.0*t*(-4.2657676160255*t + 3.13288380801275)*(-2.40898871854314*t + 2.20449435927157)*(-2.0*t + 2.0)*(2.40898871854314*t - 0.204494359271571)*(4.2657676160255*t - 1.13288380801275)
        L[4] = 1.36161054077884*t*(-5.53441558220302*t + 5.06460982524221)*(-3.76540611301375*t + 3.76540611301375)*(1.53955973039969*t - 0.130690226236839)*(2.13288380801275*t - 0.566441904006375)*(4.2657676160255*t - 2.13288380801275)
        L[5] = 1.092762477895*t*(-11.7802208683124*t + 11.7802208683124)*(1.20449435927157*t - 0.102247179635786)*(1.53955973039969*t - 0.408869504162848)*(2.40898871854314*t - 1.20449435927157)*(5.53441558220302*t - 4.06460982524221)
        L[6] = 1.0*t*(1.092762477895*t - 0.0927624778949954)*(1.36161054077884*t - 0.361610540778836)*(2.0*t - 1.0)*(3.76540611301375*t - 2.76540611301375)*(11.7802208683124*t - 10.7802208683124)
    elif m == 8:
        L[0] = (-15.5933441116591*t + 1.0)*(-4.89836122636559*t + 1.0)*(-2.52940182339839*t + 1.0)*(-1.6538504039298*t + 1.0)*(-1.25651804487402*t + 1.0)*(-1.06852438977308*t + 1.0)*(-1.0*t + 1.0)
        L[1] = 15.5933441116591*t*(-7.14183772009195*t + 1.45800552267374)*(-3.01913711486245*t + 1.1936170389907)*(-1.85007138698186*t + 1.11864494067046)*(-1.36664267006926*t + 1.08764269295176)*(-1.14713082988053*t + 1.07356541494026)*(-1.06852438977308*t + 1.06852438977308)
        L[2] = 4.89836122636559*t*(-5.23011234473426*t + 2.06772696071964)*(-2.49688077376697*t + 1.50973798345606)*(-1.69004511301302*t + 1.34502255650651)*(-1.36664267006926*t + 1.2789999771175)*(-1.25651804487402*t + 1.25651804487402)*(7.14183772009195*t - 0.458005522673742)
        L[3] = 2.52940182339839*t*(-4.77784871831648*t + 2.88892435915824)*(-2.49688077376697*t + 1.9871427903109)*(-1.85007138698186*t + 1.7314264463114)*(-1.6538504039298*t + 1.6538504039298)*(3.01913711486245*t - 0.193617038990696)*(5.23011234473426*t - 1.06772696071964)
        L[4] = 1.6538504039298*t*(-5.23011234473427*t + 4.16238538401462)*(-3.01913711486245*t + 2.82552007587175)*(-2.52940182339839*t + 2.52940182339839)*(1.85007138698186*t - 0.11864494067046)*(2.49688077376697*t - 0.509737983456064)*(4.77784871831648*t - 1.88892435915824)
        L[5] = 1.25651804487402*t*(-7.14183772009195*t + 6.6838321974182)*(-4.89836122636559*t + 4.89836122636559)*(1.36664267006926*t - 0.0876426929517591)*(1.69004511301302*t - 0.345022556506511)*(2.49688077376697*t - 0.987142790310902)*(5.23011234473427*t - 3.16238538401462)
        L[6] = 1.06852438977308*t*(-15.5933441116591*t + 15.5933441116591)*(1.14713082988053*t - 0.0735654149402642)*(1.36664267006926*t - 0.278999977117503)*(1.85007138698186*t - 0.731426446311402)*(3.01913711486245*t - 1.82552007587175)*(7.14183772009195*t - 5.6838321974182)
        L[7] = 1.0*t*(1.06852438977308*t - 0.0685243897730792)*(1.25651804487402*t - 0.256518044874023)*(1.6538504039298*t - 0.653850403929795)*(2.52940182339839*t - 1.52940182339839)*(4.89836122636559*t - 3.89836122636559)*(15.5933441116591*t - 14.5933441116591)
    elif m == 9:
        L[0] = (-19.9517159319522*t + 1.0)*(-6.19552352659845*t + 1.0)*(-3.1402965011654*t + 1.0)*(-2.0*t + 1.0)*(-1.46722498469511*t + 1.0)*(-1.19247338499778*t + 1.0)*(-1.05276567059102*t + 1.0)*(-1.0*t + 1.0)
        L[1] = 19.9517159319522*t*(-8.985867732143*t + 1.45038069721874)*(-3.72688956999172*t + 1.18679544068805)*(-2.22281992513487*t + 1.11140996256743)*(-1.58368743756201*t + 1.07937600169145)*(-1.26827563396219*t + 1.06356724595959)*(-1.11140996256743*t + 1.05570498128372)*(-1.05276567059102*t + 1.05276567059102)
        L[2] = 6.19552352659845*t*(-6.36803114515111*t + 2.02784391307886)*(-2.95339710876154*t + 1.47669855438077)*(-1.92251543148805*t + 1.31030717956834)*(-1.47669855438077*t + 1.23834927719039)*(-1.26827563396219*t + 1.20470838800261)*(-1.19247338499778*t + 1.19247338499778)*(8.985867732143*t - 0.450380697218745)
        L[3] = 3.1402965011654*t*(-5.50785957504205*t + 2.75392978752102)*(-2.75392978752102*t + 1.87696489376051)*(-1.92251543148805*t + 1.61220825191971)*(-1.58368743756201*t + 1.50431143587056)*(-1.46722498469511*t + 1.46722498469511)*(3.72688956999172*t - 0.186795440688046)*(6.36803114515111*t - 1.02784391307886)
        L[4] = 2.0*t*(-5.50785957504205*t + 3.75392978752102)*(-2.95339710876154*t + 2.47669855438077)*(-2.22281992513487*t + 2.11140996256743)*(-2.0*t + 2.0)*(2.22281992513487*t - 0.111409962567434)*(2.95339710876154*t - 0.476698554380772)*(5.50785957504205*t - 1.75392978752102)
        L[5] = 1.46722498469511*t*(-6.36803114515112*t + 5.34018723207225)*(-3.72688956999172*t + 3.54009412930368)*(-3.1402965011654*t + 3.1402965011654)*(1.58368743756201*t - 0.0793760016914519)*(1.92251543148805*t - 0.310307179568338)*(2.75392978752102*t - 0.876964893760512)*(5.50785957504205*t - 2.75392978752102)
        L[6] = 1.19247338499778*t*(-8.985867732143*t + 8.53548703492426)*(-6.19552352659845*t + 6.19552352659845)*(1.26827563396219*t - 0.0635672459595857)*(1.47669855438077*t - 0.238349277190386)*(1.92251543148805*t - 0.612208251919708)*(2.95339710876154*t - 1.47669855438077)*(6.36803114515112*t - 4.34018723207225)
        L[7] = 1.05276567059102*t*(-19.9517159319522*t + 19.9517159319522)*(1.11140996256743*t - 0.0557049812837168)*(1.26827563396219*t - 0.204708388002607)*(1.58368743756201*t - 0.504311435870556)*(2.22281992513487*t - 1.11140996256743)*(3.72688956999172*t - 2.54009412930368)*(8.985867732143*t - 7.53548703492426)
        L[8] = 1.0*t*(1.05276567059102*t - 0.0527656705910212)*(1.19247338499778*t - 0.192473384997779)*(1.46722498469511*t - 0.467224984695109)*(2.0*t - 1.0)*(3.1402965011654*t - 2.1402965011654)*(6.19552352659845*t - 5.19552352659845)*(19.9517159319522*t - 18.9517159319522)
    elif m == 10:
        L[0] = (-24.8551899865768*t + 1.0)*(-7.65620178397452*t + 1.0)*(-3.83086684428577*t + 1.0)*(-2.39601004235935*t + 1.0)*(-1.71632722520386*t + 1.0)*(-1.35324868847807*t + 1.0)*(-1.15023583005065*t + 1.0)*(-1.04191959907101*t + 1.0)*(-1.0*t + 1.0)
        L[1] = 24.8551899865768*t*(-11.0643921418274*t + 1.4451541970833)*(-4.52889363351105*t + 1.18221118550922)*(-2.65162329882488*t + 1.1066828819356)*(-1.84363595140857*t + 1.07417508988683)*(-1.43116914575603*t + 1.05758029395587)*(-1.20604873970641*t + 1.04852301432247)*(-1.08750747647141*t + 1.04375373823571)*(-1.04191959907101*t + 1.04191959907101)
        L[2] = 7.65620178397452*t*(-7.66727359298271*t + 2.00144612293675)*(-3.48738929336059*t + 1.45549861298851)*(-2.21226011315119*t + 1.28895007936987)*(-1.64379218215821*t + 1.21470073915749)*(-1.35359417439217*t + 1.17679708719609)*(-1.20604873970641*t + 1.15752572538394)*(-1.15023583005065*t + 1.15023583005065)*(11.0643921418274*t - 0.445154197083297)
        L[3] = 3.83086684428577*t*(-6.39701147705249*t + 2.66986004397267)*(-3.10943384632974*t + 1.81167891569185)*(-2.09237873100499*t + 1.54618936550249)*(-1.64379218215821*t + 1.42909144300072)*(-1.43116914575603*t + 1.37358885180016)*(-1.35324868847807*t + 1.35324868847807)*(4.52889363351105*t - 0.18221118550922)*(7.66727359298271*t - 1.00144612293675)
        L[4] = 2.39601004235935*t*(-6.05037697550395*t + 3.52518848775197)*(-3.10943384632974*t + 2.29775493063789)*(-2.21226011315119*t + 1.92331003378132)*(-1.84363595140857*t + 1.76946086152174)*(-1.71632722520386*t + 1.71632722520386)*(2.65162329882488*t - 0.1066828819356)*(3.48738929336059*t - 0.455498612988515)*(6.39701147705249*t - 1.66986004397267)
        L[5] = 1.71632722520386*t*(-6.3970114770525*t + 4.72715143307982)*(-3.48738929336059*t + 3.03189068037207)*(-2.65162329882488*t + 2.54494041688928)*(-2.39601004235935*t + 2.39601004235935)*(1.84363595140857*t - 0.0741750898868301)*(2.21226011315119*t - 0.288950079369872)*(3.10943384632974*t - 0.81167891569185)*(6.05037697550395*t - 2.52518848775197)
        L[6] = 1.35324868847807*t*(-7.6672735929827*t + 6.66582747004595)*(-4.52889363351105*t + 4.34668244800183)*(-3.83086684428577*t + 3.83086684428577)*(1.43116914575603*t - 0.0575802939558676)*(1.64379218215821*t - 0.214700739157489)*(2.09237873100499*t - 0.546189365502493)*(3.10943384632974*t - 1.29775493063789)*(6.3970114770525*t - 3.72715143307982)
        L[7] = 1.15023583005065*t*(-11.0643921418274*t + 10.6192379447441)*(-7.65620178397452*t + 7.65620178397452)*(1.20604873970641*t - 0.0485230143224714)*(1.35359417439217*t - 0.176797087196086)*(1.64379218215821*t - 0.429091443000724)*(2.21226011315119*t - 0.923310033781319)*(3.48738929336059*t - 2.03189068037207)*(7.6672735929827*t - 5.66582747004595)
        L[8] = 1.04191959907101*t*(-24.8551899865768*t + 24.8551899865768)*(1.08750747647141*t - 0.0437537382357056)*(1.20604873970641*t - 0.157525725383942)*(1.43116914575603*t - 0.373588851800161)*(1.84363595140857*t - 0.769460861521743)*(2.65162329882488*t - 1.54494041688928)*(4.52889363351105*t - 3.34668244800183)*(11.0643921418274*t - 9.61923794474411)
        L[9] = 1.0*t*(1.04191959907101*t - 0.041919599071007)*(1.15023583005065*t - 0.150235830050646)*(1.35324868847807*t - 0.353248688478069)*(1.71632722520386*t - 0.716327225203863)*(2.39601004235935*t - 1.39601004235935)*(3.83086684428577*t - 2.83086684428577)*(7.65620178397452*t - 6.65620178397452)*(24.8551899865768*t - 23.8551899865768)
    elif m == 11:
        L[0] = (-30.3036870702759*t + 1.0)*(-9.28003078925822*t + 1.0)*(-4.60018976744815*t + 1.0)*(-2.83993341075636*t + 1.0)*(-2.0*t + 1.0)*(-1.54349792995439*t + 1.0)*(-1.27776313599958*t + 1.0)*(-1.12077249776623*t + 1.0)*(-1.03412539854121*t + 1.0)*(-1.0*t + 1.0)
        L[1] = 30.3036870702759*t*(-13.3763197648032*t + 1.44140898544071)*(-5.42349196820379*t + 1.17897135604742)*(-3.13360127122141*t + 1.10340660078605)*(-2.14132434371777*t + 1.07066217185889)*(-1.62633416751005*t + 1.05366786436708)*(-1.3340121165804*t + 1.04402144575631)*(-1.16381586783909*t + 1.03840509127289)*(-1.07066217185889*t + 1.03533108592944)*(-1.03412539854121*t + 1.03412539854121)
        L[2] = 9.28003078925822*t*(-9.12208395101377*t + 1.98297992303783)*(-4.09227810424707*t + 1.44097678091585)*(-2.54944822567262*t + 1.27472411283631)*(-1.8514376625322*t + 1.19950770687908)*(-1.48179013215418*t + 1.15967513102105)*(-1.27472411283631*t + 1.13736205641816)*(-1.16381586783909*t + 1.1254107765662)*(-1.12077249776623*t + 1.12077249776623)*(13.3763197648032*t - 0.44140898544071)
        L[3] = 4.60018976744815*t*(-7.42177840558877*t + 2.61336353080621)*(-3.53834925822573*t + 1.76917462911286)*(-2.32289800900418*t + 1.50495699665293)*(-1.76917462911286*t + 1.38458731455643)*(-1.48179013215418*t + 1.32211500113313)*(-1.3340121165804*t + 1.28999067082409)*(-1.27776313599958*t + 1.27776313599958)*(5.42349196820379*t - 0.178971356047415)*(9.12208395101377*t - 0.982979923037833)
        L[4] = 2.83993341075636*t*(-6.76228228187519*t + 3.38114114093759)*(-3.38114114093759*t + 2.1905705704688)*(-2.32289800900418*t + 1.81794101235124)*(-1.8514376625322*t + 1.65192995565312)*(-1.62633416751005*t + 1.57266630314297)*(-1.54349792995439*t + 1.54349792995439)*(3.13360127122141*t - 0.10340660078605)*(4.09227810424707*t - 0.44097678091585)*(7.42177840558877*t - 1.61336353080621)
        L[5] = 2.0*t*(-6.76228228187519*t + 4.38114114093759)*(-3.53834925822573*t + 2.76917462911286)*(-2.54944822567262*t + 2.27472411283631)*(-2.14132434371777*t + 2.07066217185889)*(-2.0*t + 2.0)*(2.14132434371777*t - 0.0706621718588873)*(2.54944822567262*t - 0.274724112836312)*(3.53834925822573*t - 0.769174629112865)*(6.76228228187519*t - 2.38114114093759)
        L[6] = 1.54349792995439*t*(-7.42177840558877*t + 5.80841487478256)*(-4.09227810424707*t + 3.65130132333122)*(-3.13360127122141*t + 3.03019467043536)*(-2.83993341075636*t + 2.83993341075636)*(1.62633416751005*t - 0.0536678643670817)*(1.8514376625322*t - 0.199507706879084)*(2.32289800900418*t - 0.504956996652934)*(3.38114114093759*t - 1.1905705704688)*(6.76228228187519*t - 3.38114114093759)
        L[7] = 1.27776313599958*t*(-9.12208395101377*t + 8.13910402797593)*(-5.42349196820379*t + 5.24452061215638)*(-4.60018976744815*t + 4.60018976744815)*(1.3340121165804*t - 0.0440214457563119)*(1.48179013215418*t - 0.15967513102105)*(1.76917462911286*t - 0.384587314556432)*(2.32289800900418*t - 0.817941012351244)*(3.53834925822573*t - 1.76917462911286)*(7.42177840558877*t - 4.80841487478256)
        L[8] = 1.12077249776623*t*(-13.3763197648032*t + 12.9349107793625)*(-9.28003078925822*t + 9.28003078925822)*(1.16381586783909*t - 0.0384050912728915)*(1.27472411283631*t - 0.137362056418156)*(1.48179013215418*t - 0.322115001133131)*(1.8514376625322*t - 0.651929955653119)*(2.54944822567262*t - 1.27472411283631)*(4.09227810424707*t - 2.65130132333122)*(9.12208395101377*t - 7.13910402797593)
        L[9] = 1.03412539854121*t*(-30.3036870702759*t + 30.3036870702759)*(1.07066217185889*t - 0.0353310859294436)*(1.16381586783909*t - 0.125410776566197)*(1.3340121165804*t - 0.289990670824089)*(1.62633416751005*t - 0.572666303142971)*(2.14132434371777*t - 1.07066217185889)*(3.13360127122141*t - 2.03019467043536)*(5.42349196820379*t - 4.24452061215638)*(13.3763197648032*t - 11.9349107793625)
        L[10] = 1.0*t*(1.03412539854121*t - 0.0341253985412077)*(1.12077249776623*t - 0.12077249776623)*(1.27776313599958*t - 0.277763135999581)*(1.54349792995439*t - 0.543497929954389)*(2.0*t - 1.0)*(2.83993341075636*t - 1.83993341075636)*(4.60018976744815*t - 3.60018976744815)*(9.28003078925822*t - 8.28003078925822)*(30.3036870702759*t - 29.3036870702759)
    return L


@cuda.jit(device=True)
def compute_I(m, t, I):
    if m == 3:
        I[0] = 0.666666666666667*t**3 - 1.5*t**2 + 1.0*t
        I[1] = -1.33333333333333*t**3 + 2.0*t**2
        I[2] = 0.666666666666667*t**3 - 0.5*t**2
    elif m == 4:
        I[0] = -1.25*t**4 + 3.33333333333333*t**3 - 3.0*t**2 + 1.0*t
        I[1] = 2.79508497187474*t**4 - 6.42350327708281*t**3 + 4.04508497187474*t**2
        I[2] = -2.79508497187474*t**4 + 4.75683661041614*t**3 - 1.54508497187474*t**2
        I[3] = 1.25*t**4 - 1.66666666666667*t**3 + 0.5*t**2
    elif m == 5:
        I[0] = 2.8*t**5 - 8.75*t**4 + 10.0*t**3 - 5.0*t**2 + 1.0*t
        I[1] = -6.53333333333333*t**5 + 19.0065024887242*t**4 - 18.9574494218929*t**3 + 6.75650248872424*t**2
        I[2] = 7.46666666666666*t**5 - 18.6666666666667*t**4 + 14.2222222222222*t**3 - 2.66666666666667*t**2
        I[3] = -6.53333333333333*t**5 + 13.6601641779424*t**4 - 8.2647728003293*t**3 + 1.41016417794243*t**2
        I[4] = 2.8*t**5 - 5.25*t**4 + 3.0*t**3 - 0.5*t**2
    elif m == 6:
        I[0] = -7.0*t**6 + 25.2*t**5 - 35.0*t**4 + 23.3333333333333*t**3 - 7.5*t**2 + 1.0*t
        I[1] = 16.6787017743863*t**6 - 57.6921830763946*t**5 + 74.9219643315031*t**4 - 43.8606614876656*t**3 + 10.1414159363197*t**2
        I[2] = -20.1945761807739*t**6 + 64.0398062955575*t**5 - 72.3643588846517*t**4 + 32.8327452286913*t**3 - 4.03618727030535*t**2
        I[3] = 20.1945761807739*t**6 - 57.1276507890862*t**5 + 55.0839701184735*t**4 - 20.1181509698197*t**3 + 2.24468464817617*t**2
        I[4] = -16.6787017743863*t**6 + 42.3800275699233*t**5 - 36.6415755653249*t**4 + 12.4794005621274*t**3 - 1.34991331419049*t**2
        I[5] = 7.0*t**6 - 16.8*t**5 + 14.0*t**4 - 4.66666666666667*t**3 + 0.5*t**2
    elif m == 7:
        I[0] = 18.8571428571429*t**7 - 77.0*t**6 + 126.0*t**5 - 105.0*t**4 + 46.6666666666667*t**3 - 10.5*t**2 + 1.0*t
        I[1] = -45.466237312795*t**7 + 181.151005331173*t**6 - 285.344064013286*t**5 + 222.886398816111*t**4 - 87.2902664004418*t**3 + 14.2015766029198*t**2
        I[2] = 56.7805230270808*t**7 - 214.261027094548*t**6 + 311.11412930341*t**5 - 212.883872728861*t**4 + 65.135105409068*t**3 - 5.66898522554551*t**2
        I[3] = -60.3428571428571*t**7 + 211.2*t**6 - 276.48*t**5 + 163.2*t**4 - 40.5333333333333*t**3 + 3.2*t**2
        I[4] = 56.7805230270808*t**7 - 183.202634095018*t**6 + 217.93895030482*t**5 - 116.089673317802*t**4 + 26.8386715846004*t**3 - 2.04996481307674*t**2
        I[5] = -45.466237312795*t**7 + 137.112655858392*t**6 - 153.229015594945*t**5 + 77.8871472305521*t**4 - 17.4835105932266*t**3 + 1.31737343570243*t**2
        I[6] = 18.8571428571429*t**7 - 55.0*t**6 + 60.0*t**5 - 30.0*t**4 + 6.66666666666667*t**3 - 0.5*t**2
    elif m == 8:
        I[0] = -53.625*t**8 + 245.142857142857*t**7 - 462.0*t**6 + 462.0*t**5 - 262.5*t**4 + 84.0*t**3 - 14.0*t**2 + 1.0*t
        I[1] = 130.251563492062*t**8 - 585.889406712349*t**7 + 1078.33209806738*t**6 - 1039.18328738603*t**5 + 554.291632225413*t**4 - 156.634846180019*t**3 + 18.9375986071174*t**2
        I[2] = -165.730189263207*t**8 + 718.956518799109*t**7 - 1256.59193010952*t**6 + 1119.98956863724*t**5 - 525.459449684388*t**4 + 116.575332786358*t**3 - 7.56928981934849*t**2
        I[3] = 182.237019975786*t**8 - 750.743546048177*t**7 + 1223.76747132753*t**6 - 989.461680242413*t**5 + 403.089250788295*t**4 - 72.9801945679559*t**3 + 4.29790816426518*t**2
        I[4] = -182.237019975786*t**8 + 707.152613758108*t**7 - 1071.19920831229*t**6 + 792.80179935504*t**5 - 292.860206107967*t**4 + 49.3584396694795*t**3 - 2.81018898925795*t**2
        I[5] = 165.730189263207*t**8 - 606.88499530655*t**7 + 864.341597885566*t**6 - 602.365715978217*t**5 + 212.025648596717*t**4 - 34.6178225400263*t**3 + 1.94165942554412*t**2
        I[6] = -130.251563492062*t**8 + 456.123101224145*t**7 - 624.150028858668*t**6 + 421.219315614383*t**5 - 144.83687581807*t**4 + 23.2990908321636*t**3 - 1.29768738832023*t**2
        I[7] = 53.625*t**8 - 183.857142857143*t**7 + 247.5*t**6 - 165.0*t**5 + 56.25*t**4 - 9.0*t**3 + 0.5*t**2
    elif m == 9:
        I[0] = 158.888888888889*t**9 - 804.375*t**8 + 1716.0*t**7 - 2002.0*t**6 + 1386.0*t**5 - 577.5*t**4 + 140.0*t**3 - 18.0*t**2 + 1.0*t
        I[1] = -387.826688013941*t**9 + 1941.50456296089*t**8 - 4077.31662523114*t**7 + 4648.19720706004*t**6 - 3103.47526891263*t**5 + 1215.16423297818*t**4 - 260.5144183322*t**3 + 24.3497451715931*t**2
        I[2] = 499.512746224461*t**9 - 2438.08039573854*t**8 + 4944.99720013829*t**7 - 5362.67805176992*t**6 + 3318.6004771666*t**5 - 1145.98060795666*t**4 + 193.504602949225*t**3 - 9.73870165721154*t**2
        I[3] = -561.114629639091*t**9 + 2639.62550156796*t**8 - 5099.39149496636*t**7 + 5175.54485696907*t**6 - 2916.91759625291*t**5 + 878.352192599255*t**4 - 121.470579929397*t**3 + 5.54496390694938*t**2
        I[4] = 581.079365079365*t**9 - 2614.85714285714*t**8 + 4781.45306122449*t**7 - 4532.41904761905*t**6 + 2349.34857142857*t**5 - 643.657142857143*t**4 + 82.8952380952381*t**3 - 3.65714285714286*t**2
        I[5] = -561.114629639091*t**9 + 2410.40616518386*t**8 - 4182.51414942995*t**7 + 3744.31045357618*t**6 - 1832.28509545165*t**5 + 478.423482719909*t**4 - 59.6437583803321*t**3 + 2.59074567655936*t**2
        I[6] = 499.512746224461*t**9 - 2057.53432028161*t**8 + 3422.8128983106*t**7 - 2945.12195137384*t**6 + 1393.57723237532*t**5 - 354.73132875239*t**4 + 43.4964337271693*t**3 - 1.87444087344698*t**2
        I[7] = -387.826688013941*t**9 + 1548.93562916459*t**8 - 2507.04089004594*t**7 + 2108.33319982419*t**6 - 979.848320353303*t**5 + 246.179171268854*t**4 - 29.9341847963702*t**3 + 1.28483063269959*t**2
        I[8] = 158.888888888889*t**9 - 625.625*t**8 + 1001.0*t**7 - 834.166666666666*t**6 + 385.0*t**5 - 96.2499999999999*t**4 + 11.6666666666667*t**3 - 0.5*t**2
    elif m == 10:
        I[0] = -486.2*t**10 + 2701.11111111111*t**9 - 6435.0*t**8 + 8580.0*t**7 - 7007.0*t**6 + 3603.6*t**5 - 1155.0*t**4 + 220.0*t**3 - 22.5*t**2 + 1.0*t
        I[1] = 1190.81979427469*t**10 - 6562.43184879089*t**9 + 15463.8202687062*t**8 - 20303.4308538806*t**7 + 16208.8010054132*t**6 - 8043.52080014334*t**5 + 2424.35137490418*t**4 - 408.780432517271*t**3 + 30.4381450292819*t**2
        I[2] = -1546.69844296572*t**10 + 8368.30354086329*t**9 - 19241.372784806*t**8 + 24422.4787237694*t**7 - 18569.1100267371*t**6 + 8553.32282578742*t**5 - 2277.81396755133*t**4 + 303.180523018514*t**3 - 12.1779467074298*t**2
        I[3] = 1762.56189457901*t**10 - 9280.79408678643*t**9 + 20602.5601160653*t**8 - 24957.700515674*t**7 + 17800.914867114*t**6 - 7487.64592857272*t**5 + 1743.88572129791*t**4 - 190.579835166397*t**3 + 6.94378848513395*t**2
        I[4] = -1866.60844096158*t**10 + 9504.43725897093*t**9 - 20242.4877198327*t**8 + 23284.8172730461*t**7 - 15563.2642647411*t**6 + 6040.27206091424*t**5 - 1283.03695212325*t**4 + 130.63390936911*t**3 - 4.59935476110313*t**2
        I[5] = 1866.60844096158*t**10 - 9161.64715064492*t**9 + 18699.9322323657*t**8 - 20488.3560780524*t**7 + 12974.2423571094*t**6 - 4763.69559617907*t**5 + 964.854421941643*t**4 - 95.0695006550409*t**3 + 3.29464303374918*t**2
        I[6] = -1762.56189457901*t**10 + 8344.82485900369*t**9 - 16390.698591043*t**8 + 17261.6206380185*t**7 - 10519.9890787575*t**6 + 3735.04144343639*t**5 - 737.01208762951*t**4 + 71.3736170676763*t**3 - 2.45288417544269*t**2
        I[7] = 1546.69844296572*t**10 - 7098.68088879391*t**9 + 13528.0708504938*t**8 - 13853.3892394865*t**7 + 8239.37252520403*t**6 - 2867.92156320065*t**5 + 557.616718188519*t**4 - 53.4839646318684*t**3 + 1.82956393190325*t**2
        I[8] = -1190.81979427469*t**10 + 5345.76609395603*t**9 - 9988.82437194924*t**8 + 10057.9600522595*t**7 - 5899.63405127156*t**6 + 2031.34755795772*t**5 - 391.845229028159*t**4 + 37.3923501819437*t**3 - 1.27595483609266*t**2
        I[9] = 486.2*t**10 - 2160.88888888889*t**9 + 4004.0*t**8 - 4004.0*t**7 + 2335.66666666667*t**6 - 800.800000000001*t**5 + 154.0*t**4 - 14.6666666666667*t**3 + 0.5*t**2
    elif m == 11:
        I[0] = 1526.90909090909*t**11 - 9237.8*t**10 + 24310.0*t**9 - 36465.0*t**8 + 34320.0*t**7 - 21021.0*t**6 + 8408.4*t**5 - 2145.0*t**4 + 330.0*t**3 - 27.5*t**2 + 1.0*t
        I[1] = -3749.07490838776*t**11 + 22545.8147260603*t**10 - 58862.556979393*t**9 + 87348.6033374805*t**8 - 80972.9138294158*t**7 + 48496.2291089093*t**6 - 18725.0384397901*t**5 + 4494.30469312324*t**4 - 612.515769831972*t**3 + 37.2028673819619*t**2
        I[2] = 4899.05718185004*t**11 - 29058.5906678058*t**10 + 74518.9213923659*t**9 - 107963.437620795*t**8 + 96819.0856525223*t**7 - 55273.5574653838*t**6 + 19830.7636295746*t**5 - 4211.02865458582*t**4 + 453.767533493348*t**3 - 14.8873962950987*t**2
        I[3] = -5639.78413719064*t**11 + 32772.1056315837*t**10 - 81875.6590853111*t**9 + 114663.837784512*t**8 - 98277.4535240512*t**7 + 52718.6524777909*t**6 - 17305.1015215322*t**5 + 3220.48251898111*t**4 - 285.451740224998*t**3 + 8.49561949463351*t**2
        I[4] = 6065.18425911076*t**11 - 34345.1185987654*t**10 + 83126.7453898142*t**9 - 111916.676251589*t**8 + 91287.865525394*t**7 - 45997.7976681829*t**6 + 13963.6794044065*t**5 - 2374.23357499376*t**4 + 196.135342365644*t**3 - 5.64038799768588*t**2
        I[5] = -6204.58297258297*t**11 + 34125.2063492063*t**10 - 79825.0440917107*t**9 + 103273.650793651*t**8 - 80445.5328798185*t**7 + 38492.1058201058*t**6 - 11072.2031746032*t**5 + 1796.06349206349*t**4 - 143.576719576719*t**3 + 4.06349206349206*t**2
        I[6] = 6065.18425911076*t**11 - 32371.9082514529*t**10 + 73260.693653252*t**9 - 91449.0980655714*t**8 + 68613.8632006968*t**7 - 31637.1606779146*t**6 + 8803.35927648061*t**5 - 1390.97308426313*t**4 + 109.248668425165*t**3 - 3.06553920088186*t**2
        I[7] = -5639.78413719064*t**11 + 29265.5198775134*t**10 - 64342.7303149598*t**9 + 78036.7231984792*t**8 - 56966.5678020281*t**7 + 25629.5161398739*t**6 - 6987.49169938662*t**5 + 1087.09373731468*t**4 - 84.5147454769907*t**3 + 2.35976991308857*t**2
        I[8] = 4899.05718185004*t**11 - 24831.0383325445*t**10 + 53381.1597160594*t**9 - 63414.709864491*t**8 + 45450.7446851464*t**7 - 20133.5634542428*t**6 + 5421.37594147996*t**5 - 835.717104565326*t**4 + 64.5828042845875*t**3 - 1.79798803579478*t**2
        I[9] = -3749.07490838776*t**11 + 18694.0092662051*t**10 - 39603.5296801169*t**9 + 46450.1066883238*t**8 - 32933.0910284459*t**7 + 14459.5757190442*t**6 - 3866.54341662966*t**5 + 593.007976925519*t**4 - 45.6753734580645*t**3 + 1.26956267628515*t**2
        I[10] = 1526.90909090909*t**11 - 7558.20000000002*t**10 + 15912.0*t**9 - 18564.0000000001*t**8 + 13104.0*t**7 - 5733.00000000002*t**6 + 1528.8*t**5 - 234.000000000001*t**4 + 18.0*t**3 - 0.500000000000001*t**2
